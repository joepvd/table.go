#!/usr/bin/env -S bats --pretty

repo="$(git rev-parse --show-toplevel)"
binary="$repo/table"
testdir="$repo/test"

[[ -x "$binary" ]] || {
  echo No binary $binary found. Exiting.>/dev/stderr
  exit 1
}

# for test_file in "$testdir"/*.test; do
#   echo ${test_file##*/}
#   t="${test_file##*/}"
#   echo $t ${t/.test}
# done



@test "running the binary" {
  run $binary <<<'niceness very nice'
  [ "$status" -eq 0 ]
}

@test "output" {
  in=$'aaa\nbb\ncccccc'
  expected=$'┌────────┐\n│ aaa    │\n├────────┤\n│ bb     │\n│ cccccc │\n└────────┘\n'
  run $binary <<<"$in"
  [[ "$status" == 0 ]]
  skip "This is a WIP"
  [[ "$output" == "$expected" ]]
}
